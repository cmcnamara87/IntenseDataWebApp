<?xml version="1.0" encoding="utf-8"?>
<s:VGroup xmlns:fx="http://ns.adobe.com/mxml/2009" 
		  xmlns:s="library://ns.adobe.com/flex/spark" 
		  xmlns:mx="library://ns.adobe.com/flex/mx" width="100%">

	<fx:Script>
		<![CDATA[
			import Controller.IDEvent;
			import Controller.Utilities.AssetLookup;
			
			import Model.Model_Base;
			import Model.Model_ERALogItem;
			private var fileReference:FileReference;
			
			/*================================ EVENT LISTENERS ============================== */
			protected function uploadButton_clickHandler(event:MouseEvent):void
			{
				fileReference = new FileReference();
				fileReference.browse(AssetLookup.getFileTypes());
				fileReference.addEventListener(Event.SELECT, onFileSelect);

				uploadButton.label = "Uploaded";
				uploadButton.enabled = false;
			}
			
			private function onFileSelect(e:Event):void {
				uploadProgress.includeInLayout = true;
				uploadProgress.visible = true;
			}

			protected function cancelUploadButton_clickHandler(event:MouseEvent):void
			{
				uploadProgress.includeInLayout = false;
				uploadProgress.visible = false;
			}


			protected function usefulCheckbox_changeHandler(event:Event):void
			{
				if((event.target as CheckBox).selected == true) {
					// The useful box was checked
					processedCheckbox.enabled = true;
					uploadableCheckbox.enabled = true;
					uploadButton.enabled = false;
				} else {
					// The useful box has been unchecked
					processedCheckbox.enabled = false;
					uploadableCheckbox.enabled = false;
					uploadButton.enabled = false;
				}
			}


			protected function uploadableCheckbox_changeHandler(event:Event):void
			{
				// TODO Auto-generated method stub
				uploadButton.enabled = true;
			}


			protected function saveButton_clickHandler(event:MouseEvent):void
			{
				// Disable the save button while we save
				saveButton.label = "Saving...";
				saveButton.enabled = false;
				
				// Pass the type, title and description to the controller and this item itself
				var evidenceSavedEvent:IDEvent = new IDEvent(IDEvent.SAVE_LOG_ITEM, true);
				evidenceSavedEvent.data.type = evidenceType.selectedItem;
				evidenceSavedEvent.data.title = title.text;
				evidenceSavedEvent.data.description = description.text;
				evidenceSavedEvent.data.evidenceItem = this;
				dispatchEvent(evidenceSavedEvent);
			}

			public function addLogItemData(data:Model_ERALogItem):void {
				saveButton.visible = false;
				saveButton.includeInLayout = false;
				actionGroup.visible = true;
				actionGroup.includeInLayout = true;
			}

			protected function deleteEvidence_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
			}

		]]>
	</fx:Script>

	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<s:HGroup verticalAlign="middle">
		<s:Button id="deleteEvidence" label="X" width="30" click="deleteEvidence_clickHandler(event)"/>
		<s:DropDownList id="evidenceType">
			<s:ArrayList>
				<fx:String>Video</fx:String>
				<fx:String>Images</fx:String>
				<fx:String>Photos</fx:String>
				<fx:String>Document</fx:String>
				<fx:String>Physical Object</fx:String>
				<fx:String>Research Statement</fx:String>
			</s:ArrayList>
		</s:DropDownList>
		<s:TextInput id="title" text="title"/>
		<s:TextInput id="description" text=""/>
		<s:Button label="Save" id="saveButton" click="saveButton_clickHandler(event)" />
		<s:HGroup id="actionGroup" visible="false" includeInLayout="false">
			<s:CheckBox label="Useful" id="usefulCheckbox" change="usefulCheckbox_changeHandler(event)"/>
			<s:CheckBox label="Processed" id="processedCheckbox" enabled="false"/>
			<s:CheckBox label="Uploadable" id="uploadableCheckbox" enabled="false" change="uploadableCheckbox_changeHandler(event)"/>
			<s:Button label="Upload" id="uploadButton" click="uploadButton_clickHandler(event)" enabled="false" />
			<s:CheckBox label="Returned" />
		</s:HGroup>
	</s:HGroup>
	<s:HGroup id="uploadProgress" width="100%" visible="false" includeInLayout="false">
		<s:BorderContainer width="100%" height="20" backgroundColor="0xFF00FF">
		</s:BorderContainer>
		<s:Button width="50" label="X" id="cancelUploadButton" click="cancelUploadButton_clickHandler(event)"/>
	</s:HGroup>
</s:VGroup>
